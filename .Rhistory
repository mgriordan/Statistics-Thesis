boot <- cbind(df0, df1)
ggplot(boot) +
geom_density(aes(x = df0, color = 'not on chart'))+
geom_density(aes(x = df1, color = 'on chart'))+
labs(title = "Danceability")
ggplot(boot) +
geom_density(aes(x = df0, color = 'not on chart'))+
geom_density(aes(x = df1, color = 'on chart'))
#######
set.seed(1211)
n = length(tracks$billboard_flag)
B = 500
variable = tracks$danceability
tracks <- tracks[order(tracks$billboard_flag),]
BootstrapSamples <- matrix(sample(variable, size = n*B, replace = TRUE), nrow = n, ncol = B)
Boot_test_0 <- rep(0, B)
Boot_test_1 <- rep(0, B)
for (i in 1:B){
Boot_test_0[i] <- (BootstrapSamples[1:572056, i])
Boot_test_1[i] <- (BootstrapSamples[572057:586495, i])
}
df0<- data.frame(matrix(unlist(Boot_test_0), nrow=500, byrow=TRUE),stringsAsFactors=FALSE)
colnames(df0) <- "df0"
df0$index <- c(1:500)
df1<- data.frame(matrix(unlist(Boot_test_1), nrow=500, byrow=TRUE),stringsAsFactors=FALSE)
colnames(df1) <- "df1"
df0$index <- c(1:500)
boot <- cbind(df0, df1)
ggplot(boot) +
geom_density(aes(x = df0, color = 'not on chart'))+
geom_density(aes(x = df1, color = 'on chart'))
#######
set.seed(1211)
n = length(tracks$billboard_flag)
B = 500
variable = tracks$energy
tracks <- tracks[order(tracks$billboard_flag),]
BootstrapSamples <- matrix(sample(variable, size = n*B, replace = TRUE), nrow = n, ncol = B)
Boot_test_0 <- rep(0, B)
Boot_test_1 <- rep(0, B)
for (i in 1:B){
Boot_test_0[i] <- (BootstrapSamples[1:572056, i])
Boot_test_1[i] <- (BootstrapSamples[572057:586495, i])
}
for (i in 1:B){
Boot_test_0[i] <- (BootstrapSamples[1:572056, i])
Boot_test_1[i] <- (BootstrapSamples[572057:586495, i])
}
plot(density(Boot_test_0))
plot(density(Boot_test_1))
df0<- data.frame(matrix(unlist(Boot
test_0), nrow=500, byr
df0<- data.frame(matrix(unlist(Boot_test_0), nrow=500, byrow=TRUE),stringsAsFactors=FALSE)
colnames(df0) <- "df0"
df0$index <- c(1:500)
df1<- data.frame(matrix(unlist(Boot_test_1), nrow=500, byrow=TRUE),stringsAsFactors=FALSE)
colnames(df1) <- "df1"
df0$index <- c(1:500)
boot <- cbind(df0, df1)
ggplot(boot) +
geom_density(aes(x = df0, color = 'not on chart'))+
geom_density(aes(x = df1, color = 'on chart'))
#######
set.seed(1211)
n = length(tracks$billboard_flag)
B = 200
B = 500
variable = tracks$key
tracks <- tracks[order(tracks$billboard_flag),]
BootstrapSamples <- matrix(sample(variable, size = n*B, replace = TRUE), nrow = n, ncol = B)
Boot_test_0 <- rep(0, B)
Boot_test_1 <- rep(0, B)
for (i in 1:B){
Boot_test_0[i] <- (BootstrapSamples[1:572056, i])
Boot_test_1[i] <- (BootstrapSamples[572057:586495, i])
}
df0<- data.frame(matrix(unlist(Boot_test_0), nrow=500, byrow=TRUE),stringsAsFactors=FALSE)
colnames(df0) <- "df0"
df0$index <- c(1:500)
df1<- data.frame(matrix(unlist(Boot_test_1), nrow=500, byrow=TRUE),stringsAsFactors=FALSE)
colnames(df1) <- "df1"
df0$index <- c(1:500)
boot <- cbind(df0, df1)
ggplot(boot) +
geom_density(aes(x = df0, color = 'not on chart'))+
geom_density(aes(x = df1, color = 'on chart'))
#######
set.seed(1211)
n = length(tracks$billboard_flag)
B = 500
variable = tracks$loudness
tracks <- tracks[order(tracks$billboard_flag),]
BootstrapSamples <- matrix(sample(variable, size = n*B, replace = TRUE), nrow = n, ncol = B)
Boot_test_0 <- rep(0, B)
Boot_test_1 <- rep(0, B)
for (i in 1:B){
Boot_test_0[i] <- (BootstrapSamples[1:572056, i])
Boot_test_1[i] <- (BootstrapSamples[572057:586495, i])
}
df0<- data.frame(matrix(unlist(Boot_test_0), nrow=500, byrow=TRUE),stringsAsFactors=FALSE)
colnames(df0) <- "df0"
df0$index <- c(1:500)
df1<- data.frame(matrix(unlist(Boot_test_1), nrow=500, byrow=TRUE),stringsAsFactors=FALSE)
colnames(df1) <- "df1"
df0$index <- c(1:500)
boot <- cbind(df0, df1)
ggplot(boot) +
geom_density(aes(x = df0, color = 'not on chart'))+
geom_density(aes(x = df1, color = 'on chart'))+
labs(title = "loudness")
B = 500
variable = tracks$mode
tracks <- tracks[order(tracks$billboard_flag),]
tracks <- tracks[order(tracks$billboard_flag),]
BootstrapSamples <- matrix(sample(variable, size = n*B, replace = TRUE), nrow = n, ncol = B)
Boot_test_0 <- rep(0, B)
Boot_test_1 <- rep(0, B)
for (i in 1:B){
Boot_test_0[i] <- (BootstrapSamples[1:572056, i])
Boot_test_1[i] <- (BootstrapSamples[572057:586495, i])
}
df0<- data.frame(matrix(unlist(Boot_test_0), nrow=500, byrow=TRUE),stringsAsFactors=FALSE)
colnames(df0) <- "df0"
df0$index <- c(1:500)
df1<- data.frame(matrix(unlist(Boot_test_1), nrow=500, byrow=TRUE),stringsAsFactors=FALSE)
colnames(df1) <- "df1"
df0$index <- c(1:500)
boot <- cbind(df0, df1)
ggplot(boot) +
geom_density(aes(x = df0, color = 'not on chart'))+
geom_density(aes(x = df1, color = 'on chart'))+
labs(title = "mode")
B = 500
variable = tracks$speechiness
tracks <- tracks[order(tracks$billboard_flag),]
BootstrapSamples <- matrix(sample(variable, size = n*B, replace = TRUE), nrow = n, ncol = B)
Boot_test_0 <- rep(0, B)
Boot_test_1 <- rep(0, B)
for (i in 1:B){
Boot_test_0[i] <- (BootstrapSamples[1:572056, i])
Boot_test_1[i] <- (BootstrapSamples[572057:586495, i])
}
df0<- data.frame(matrix(unlist(Boot_test_0), nrow=500, byrow=TRUE),stringsAsFactors=FALSE)
colnames(df0) <- "df0"
df0$index <- c(1:500)
df1<- data.frame(matrix(unlist(Boot_test_1), nrow=500, byrow=TRUE),stringsAsFactors=FALSE)
colnames(df1) <- "df1"
df0$index <- c(1:500)
boot <- cbind(df0, df1)
ggplot(boot) +
geom_density(aes(x = df0, color = 'not on chart'))+
geom_density(aes(x = df1, color = 'on chart'))+
labs(title = "speechiness")
#bootstrap instrumentalness
set.seed(1211)
n = length(tracks$billboard_flag)
B = 500
variable = tracks$instrumentalness
tracks <- tracks[order(tracks$billboard_flag),]
BootstrapSamples <- matrix(sample(variable, size = n*B, replace = TRUE), nrow = n, ncol = B)
Boot_test_0 <- rep(0, B)
Boot_test_1 <- rep(0, B)
for (i in 1:B){
Boot_test_0[i] <- (BootstrapSamples[1:572056, i])
Boot_test_1[i] <- (BootstrapSamples[572057:586495, i])
}
df0<- data.frame(matrix(unlist(Boot_test_0), nrow=500, byrow=TRUE),stringsAsFactors=FALSE)
colnames(df0) <- "df0"
df0$index <- c(1:500)
df1<- data.frame(matrix(unlist(Boot_test_1), nrow=500, byrow=TRUE),stringsAsFactors=FALSE)
colnames(df1) <- "df1"
df0$index <- c(1:500)
boot <- cbind(df0, df1)
ggplot(boot) +
geom_density(aes(x = df0, color = 'not on chart'))+
geom_density(aes(x = df1, color = 'on chart'))+
labs(title = "instrumentalness")
#bootstrap liveness
set.seed(1211)
n = length(tracks$billboard_flag)
B = 500
variable = tracks$liveness
tracks <- tracks[order(tracks$billboard_flag),]
BootstrapSamples <- matrix(sample(variable, size = n*B, replace = TRUE), nrow = n, ncol = B)
Boot_test_0 <- rep(0, B)
Boot_test_1 <- rep(0, B)
for (i in 1:B){
Boot_test_0[i] <- (BootstrapSamples[1:572056, i])
Boot_test_1[i] <- (BootstrapSamples[572057:586495, i])
}
df0<- data.frame(matrix(unlist(Boot_test_0), nrow=500, byrow=TRUE),stringsAsFactors=FALSE)
colnames(df0) <- "df0"
df0$index <- c(1:500)
df1<- data.frame(matrix(unlist(Boot_test_1), nrow=500, byrow=TRUE),stringsAsFactors=FALSE)
colnames(df1) <- "df1"
df0$index <- c(1:500)
boot <- cbind(df0, df1)
ggplot(boot) +
geom_density(aes(x = df0, color = 'not on chart'))+
geom_density(aes(x = df1, color = 'on chart'))+
labs(title = "liveness")
#bootstrap acousticness
nrow(tracks[tracks$billboard_flag==0,])
#572056
nrow(tracks[tracks$billboard_flag==1,])
#14616
##################
set.seed(1211)
n = length(tracks$billboard_flag)
B = 500
variable = tracks$acousticness
tracks <- tracks[order(tracks$billboard_flag),]
BootstrapSamples <- matrix(sample(variable, size = n*B, replace = TRUE), nrow = n, ncol = B)
Boot_test_0 <- rep(0, B)
Boot_test_1 <- rep(0, B)
for (i in 1:B){
Boot_test_0[i] <- (BootstrapSamples[1:572056, i])
Boot_test_1[i] <- (BootstrapSamples[572057:586495, i])
}
df0<- data.frame(matrix(unlist(Boot_test_0), nrow=500, byrow=TRUE),stringsAsFactors=FALSE)
colnames(df0) <- "df0"
df0$index <- c(1:500)
df1<- data.frame(matrix(unlist(Boot_test_1), nrow=500, byrow=TRUE),stringsAsFactors=FALSE)
colnames(df1) <- "df1"
df0$index <- c(1:500)
boot <- cbind(df0, df1)
ggplot(boot) +
geom_density(aes(x = df0, color = 'not on chart'))+
geom_density(aes(x = df1, color = 'on chart'))+
labs(title = "acousticness")
#bootstrap duration
set.seed(1211)
n = length(tracks$billboard_flag)
B = 500
variable = tracks$duration_min
tracks <- tracks[order(tracks$billboard_flag),]
BootstrapSamples <- matrix(sample(variable, size = n*B, replace = TRUE), nrow = n, ncol = B)
Boot_test_0 <- rep(0, B)
Boot_test_1 <- rep(0, B)
for (i in 1:B){
Boot_test_0[i] <- (BootstrapSamples[1:572056, i])
Boot_test_1[i] <- (BootstrapSamples[572057:586495, i])
}
df0<- data.frame(matrix(unlist(Boot_test_0), nrow=500, byrow=TRUE),stringsAsFactors=FALSE)
colnames(df0) <- "df0"
df0$index <- c(1:500)
df1<- data.frame(matrix(unlist(Boot_test_1), nrow=500, byrow=TRUE),stringsAsFactors=FALSE)
colnames(df1) <- "df1"
df0$index <- c(1:500)
boot <- cbind(df0, df1)
ggplot(boot) +
geom_density(aes(x = df0, color = 'not on chart'))+
geom_density(aes(x = df1, color = 'on chart'))+
labs(title = "duration")
#bootstrap explicit
set.seed(1211)
n = length(tracks$billboard_flag)
B = 500
variable = tracks$explicit
tracks <- tracks[order(tracks$billboard_flag),]
BootstrapSamples <- matrix(sample(variable, size = n*B, replace = TRUE), nrow = n, ncol = B)
Boot_test_0 <- rep(0, B)
Boot_test_1 <- rep(0, B)
for (i in 1:B){
Boot_test_0[i] <- (BootstrapSamples[1:572056, i])
Boot_test_1[i] <- (BootstrapSamples[572057:586495, i])
}
df0<- data.frame(matrix(unlist(Boot_test_0), nrow=500, byrow=TRUE),stringsAsFactors=FALSE)
colnames(df0) <- "df0"
df0$index <- c(1:500)
df1<- data.frame(matrix(unlist(Boot_test_1), nrow=500, byrow=TRUE),stringsAsFactors=FALSE)
colnames(df1) <- "df1"
df0$index <- c(1:500)
boot <- cbind(df0, df1)
ggplot(boot) +
geom_density(aes(x = df0, color = 'not on chart'))+
geom_density(aes(x = df1, color = 'on chart'))+
labs(title = "explicit")
#bootstrap danceability
set.seed(1211)
n = length(tracks$billboard_flag)
B = 500
variable = tracks$danceability
tracks <- tracks[order(tracks$billboard_flag),]
BootstrapSamples <- matrix(sample(variable, size = n*B, replace = TRUE), nrow = n, ncol = B)
Boot_test_0 <- rep(0, B)
Boot_test_1 <- rep(0, B)
for (i in 1:B){
Boot_test_0[i] <- (BootstrapSamples[1:572056, i])
Boot_test_1[i] <- (BootstrapSamples[572057:586495, i])
}
plot(density(Boot_test_0))
plot(density(Boot_test_1))
df0<- data.frame(matrix(unlist(Boot_test_0), nrow=500, byrow=TRUE),stringsAsFactors=FALSE)
colnames(df0) <- "df0"
df0$index <- c(1:500)
df1<- data.frame(matrix(unlist(Boot_test_1), nrow=500, byrow=TRUE),stringsAsFactors=FALSE)
colnames(df1) <- "df1"
df0$index <- c(1:500)
boot <- cbind(df0, df1)
ggplot(boot) +
geom_density(aes(x = df0, color = 'not on chart'))+
geom_density(aes(x = df1, color = 'on chart'))+
labs(main = "danceability")
ggplot(boot) +
geom_density(aes(x = df0, color = 'not on chart'))+
geom_density(aes(x = df1, color = 'on chart'))+
labs(main = "danceability")
ggplot(boot) +
geom_density(aes(x = df0, color = 'not on chart'))+
geom_density(aes(x = df1, color = 'on chart'))+
labs(title = "danceability")
#bootstrap energy
set.seed(1211)
n = length(tracks$billboard_flag)
B = 500
variable = tracks$energy
tracks <- tracks[order(tracks$billboard_flag),]
BootstrapSamples <- matrix(sample(variable, size = n*B, replace = TRUE), nrow = n, ncol = B)
Boot_test_0 <- rep(0, B)
Boot_test_1 <- rep(0, B)
for (i in 1:B){
Boot_test_0[i] <- (BootstrapSamples[1:572056, i])
Boot_test_1[i] <- (BootstrapSamples[572057:586495, i])
}
df0<- data.frame(matrix(unlist(Boot_test_0), nrow=500, byrow=TRUE),stringsAsFactors=FALSE)
colnames(df0) <- "df0"
df0$index <- c(1:500)
df1<- data.frame(matrix(unlist(Boot_test_1), nrow=500, byrow=TRUE),stringsAsFactors=FALSE)
colnames(df1) <- "df1"
df0$index <- c(1:500)
boot <- cbind(df0, df1)
ggplot(boot) +
geom_density(aes(x = df0, color = 'not on chart'))+
geom_density(aes(x = df1, color = 'on chart'))+
labs(title = "energy")
#bootstrap key
set.seed(1211)
n = length(tracks$billboard_flag)
B = 500
variable = tracks$key
tracks <- tracks[order(tracks$billboard_flag),]
BootstrapSamples <- matrix(sample(variable, size = n*B, replace = TRUE), nrow = n, ncol = B)
Boot_test_0 <- rep(0, B)
Boot_test_1 <- rep(0, B)
for (i in 1:B){
Boot_test_0[i] <- (BootstrapSamples[1:572056, i])
Boot_test_1[i] <- (BootstrapSamples[572057:586495, i])
}
df0<- data.frame(matrix(unlist(Boot_test_0), nrow=500, byrow=TRUE),stringsAsFactors=FALSE)
colnames(df0) <- "df0"
df0$index <- c(1:500)
df1<- data.frame(matrix(unlist(Boot_test_1), nrow=500, byrow=TRUE),stringsAsFactors=FALSE)
colnames(df1) <- "df1"
df0$index <- c(1:500)
boot <- cbind(df0, df1)
ggplot(boot) +
geom_density(aes(x = df0, color = 'not on chart'))+
geom_density(aes(x = df1, color = 'on chart'))+
labs(title = "key")
#bootstrap loudness
set.seed(1211)
n = length(tracks$billboard_flag)
B = 500
variable = tracks$loudness
tracks <- tracks[order(tracks$billboard_flag),]
BootstrapSamples <- matrix(sample(variable, size = n*B, replace = TRUE), nrow = n, ncol = B)
Boot_test_0 <- rep(0, B)
Boot_test_1 <- rep(0, B)
for (i in 1:B){
Boot_test_0[i] <- (BootstrapSamples[1:572056, i])
Boot_test_1[i] <- (BootstrapSamples[572057:586495, i])
}
df0<- data.frame(matrix(unlist(Boot_test_0), nrow=500, byrow=TRUE),stringsAsFactors=FALSE)
colnames(df0) <- "df0"
df0$index <- c(1:500)
df1<- data.frame(matrix(unlist(Boot_test_1), nrow=500, byrow=TRUE),stringsAsFactors=FALSE)
colnames(df1) <- "df1"
df0$index <- c(1:500)
boot <- cbind(df0, df1)
ggplot(boot) +
geom_density(aes(x = df0, color = 'not on chart'))+
geom_density(aes(x = df1, color = 'on chart'))+
labs(title = "loudness")
#bootstrap instrumentalness
set.seed(1211)
n = length(tracks$billboard_flag)
B = 500
variable = tracks$instrumentalness
tracks <- tracks[order(tracks$billboard_flag),]
BootstrapSamples <- matrix(sample(variable, size = n*B, replace = TRUE), nrow = n, ncol = B)
Boot_test_0 <- rep(0, B)
Boot_test_1 <- rep(0, B)
for (i in 1:B){
Boot_test_0[i] <- (BootstrapSamples[1:572056, i])
Boot_test_1[i] <- (BootstrapSamples[572057:586495, i])
}
df0<- data.frame(matrix(unlist(Boot_test_0), nrow=500, byrow=TRUE),stringsAsFactors=FALSE)
colnames(df0) <- "df0"
df0$index <- c(1:500)
df1<- data.frame(matrix(unlist(Boot_test_1), nrow=500, byrow=TRUE),stringsAsFactors=FALSE)
colnames(df1) <- "df1"
df0$index <- c(1:500)
boot <- cbind(df0, df1)
ggplot(boot) +
geom_density(aes(x = df0, color = 'not on chart'))+
geom_density(aes(x = df1, color = 'on chart'))+
labs(title = "instrumentalness")
#bootstrap valence
set.seed(1211)
n = length(tracks$billboard_flag)
B = 500
variable = tracks$valence
tracks <- tracks[order(tracks$billboard_flag),]
BootstrapSamples <- matrix(sample(variable, size = n*B, replace = TRUE), nrow = n, ncol = B)
Boot_test_0 <- rep(0, B)
Boot_test_1 <- rep(0, B)
for (i in 1:B){
Boot_test_0[i] <- (BootstrapSamples[1:572056, i])
Boot_test_1[i] <- (BootstrapSamples[572057:586495, i])
}
df0<- data.frame(matrix(unlist(Boot_test_0), nrow=500, byrow=TRUE),stringsAsFactors=FALSE)
colnames(df0) <- "df0"
df0$index <- c(1:500)
df1<- data.frame(matrix(unlist(Boot_test_1), nrow=500, byrow=TRUE),stringsAsFactors=FALSE)
colnames(df1) <- "df1"
df0$index <- c(1:500)
boot <- cbind(df0, df1)
ggplot(boot) +
geom_density(aes(x = df0, color = 'not on chart'))+
geom_density(aes(x = df1, color = 'on chart'))+
labs(title = "valence")
#bootstrap tempo
set.seed(1211)
n = length(tracks$billboard_flag)
B = 500
variable = tracks$tempo
tracks <- tracks[order(tracks$billboard_flag),]
BootstrapSamples <- matrix(sample(variable, size = n*B, replace = TRUE), nrow = n, ncol = B)
Boot_test_0 <- rep(0, B)
Boot_test_1 <- rep(0, B)
for (i in 1:B){
Boot_test_0[i] <- (BootstrapSamples[1:572056, i])
Boot_test_1[i] <- (BootstrapSamples[572057:586495, i])
}
df0<- data.frame(matrix(unlist(Boot_test_0), nrow=500, byrow=TRUE),stringsAsFactors=FALSE)
colnames(df0) <- "df0"
df0$index <- c(1:500)
df1<- data.frame(matrix(unlist(Boot_test_1), nrow=500, byrow=TRUE),stringsAsFactors=FALSE)
colnames(df1) <- "df1"
df0$index <- c(1:500)
boot <- cbind(df0, df1)
ggplot(boot) +
geom_density(aes(x = df0, color = 'not on chart'))+
geom_density(aes(x = df1, color = 'on chart'))+
labs(title = "tempo")
#bootstrap time_signature
set.seed(1211)
n = length(tracks$billboard_flag)
B = 500
variable = tracks$time_signature
tracks <- tracks[order(tracks$billboard_flag),]
BootstrapSamples <- matrix(sample(variable, size = n*B, replace = TRUE), nrow = n, ncol = B)
Boot_test_0 <- rep(0, B)
Boot_test_1 <- rep(0, B)
for (i in 1:B){
Boot_test_0[i] <- (BootstrapSamples[1:572056, i])
Boot_test_1[i] <- (BootstrapSamples[572057:586495, i])
}
df0<- data.frame(matrix(unlist(Boot_test_0), nrow=500, byrow=TRUE),stringsAsFactors=FALSE)
colnames(df0) <- "df0"
df0$index <- c(1:500)
df1<- data.frame(matrix(unlist(Boot_test_1), nrow=500, byrow=TRUE),stringsAsFactors=FALSE)
colnames(df1) <- "df1"
df0$index <- c(1:500)
boot <- cbind(df0, df1)
ggplot(boot) +
geom_density(aes(x = df0, color = 'not on chart'))+
geom_density(aes(x = df1, color = 'on chart'))+
labs(title = "time signature")
install.packages("Boruta")
install.packages("caret")
library(sqldf)
library(dplyr)
library(ggplot2)
library(corrplot)
library(Hmisc)
library(Boruta)
library(mlbench)
library(caret)
library(randomForest)
boruta <- Boruta(Billboard_flag ~ duration + energy + key + liveness + valence + tempo + time_signature + decade, data = tracks, doTrace = 2)
View(tracks)
boruta <- Boruta(billboard_flag ~ duration + energy + key + liveness + valence + tempo + time_signature + decade, data = tracks, doTrace = 2)
boruta <- Boruta(billboard_flag ~ duration_min + energy + key + liveness + valence + tempo + time_signature + decade, data = tracks, doTrace = 2)
install.packages('Rcpp')
library(Rcpp)
library(Rcpp)
boruta <- Boruta(billboard_flag ~ duration_min + energy + key + liveness + valence + tempo + time_signature + decade, data = tracks, doTrace = 2)
library(sqldf)
library(dplyr)
library(ggplot2)
library(corrplot)
library(Hmisc)
library(Boruta)
library(mlbench)
library(caret)
library(randomForest)
library(Rcpp)
set.seed(1211)
boruta <- Boruta(billboard_flag ~ duration_min + energy + key + liveness + valence + tempo + time_signature + decade, data = tracks, doTrace = 2)
update.packages()
